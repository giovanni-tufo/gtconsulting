version: '3'

services:
  reverse-proxy:
    image: traefik # The official Traefik docker image
    command: --api --docker # Enables the web UI and tells Tr√¶fik to listen to docker
    ports:
    - "80:80"     # The HTTP port
    - "443:443"
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock # So that Traefik can listen to the Docker events
    - ./traefik/traefik.toml:/traefik.toml
    - ./traefik/acme.json:/acme.json
    labels:
      - "traefik.frontend.rule=Host:traefik.gtconsulting.eu"
      - "traefik.port=8080"
      - "traefik.frontend.auth.basic=giovanni:$$apr1$$yoSEfUw3$$CtDVZzqvHCqwKJBgvoKgc."
    networks:
      - web
    restart: always
  web:
    image: nginx:alpine
    volumes:
      - ./www:/usr/share/nginx/html
    networks:
      - web
      - default
    expose:
      - 80
    labels:
    - "traefik.docker.network=web"
    - "traefik.enable=true"
    - "traefik.frontend.rule=Host:gtconsulting.eu"
    - "traefik.port=80"
    restart: always

networks:
  web:
    external: true